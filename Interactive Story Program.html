<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Eeveelutions</title>
</head>
<body>
    <h1 id = "Story"> </h1>
    <script>
    
    const storyObject = {storyParts: {introduction: "introduction", forest: "went to forest", cave: "went to cave", ruins: "went to ruins", antidote: "took antidote", noAntidote: "didn't take antidote", leftForForest: "left cave to go to forest", "left for ruins": "left cave to go to ruins", keptSearchingRuins: "kept searching ruins", triedToLeaveRuins: "attempted to leave the ruins", wentIntoSewer: "went into sewer and lost to rival", sewerWithForestNoCave: "fainted in sewers and woke up in flooded mansion", noSewerToday: "didn't go into sewer", straightToFloodedMansion: "didn't prepare first", prepareFirst: "stopped to train first", chinchou: "led by chinchou to beat rival", carvahna: "led by carvahna to beat rival", megaEevee: "took the mega eevee stone", sylveon: "evolved into sylveon", espeon: "evolved into espeon", umbreon: "evolved into umbreon", jolteon: "evolved into jolteon", vaporeon: "evolved into vaporeon", flareon: "evolved into flareon", leafeon: "evolved into leafeon", glaceon: "evolved into glaceon", ending: "returned to visit parents at daycare after becoming the very best like no one ever was"}, choices: {goToForest: ["Go to forest", 1], goToCave: ["Go to cave", 1], goToRuins: ["Go to ruins", 1], takeAntidote: ["Get him to buy it", 2], leaveAntidote: ["Don't let him buy it for you", 2], keepTraining: ["Continue training here", 3], leaveForForest: ["Go to forest instead", 3], leaveForRuins: ["Go to ruins instead", 3], keepSearching: ["Keep searching", 4], leave: ["Leave", 4], goIntoSewer: ["Check it out", 5], "don't go into sewer": ["Ignore it; it's probably nothing", 5], chooseChinchou: ["Left", 6], chooseCarvahna: ["Right", 6], prepare: ["Prepare first", 7], leaveAtOnce: ["Head straight for Flooded Mansion", 7], megaEevee: ["Mega Eevee", 8], jolteon: ["Thunder Stone", 8], flareon: ["Fire Stone", 8], vaporeon: ["Water Stone", 8], umbreon: ["Rare Candy", 8], espeon: ["Rare Candy", 8], leafeon: ["Grassy Rock", 8], glaceon: ["Icy Rock", 8], sylveon: ["TM", 8]}}
    let currentStory = [{}, "introduction"];

    function displayStory () {
        let text = "";
        while (retrieveCurrentStoryPart() != "returned to visit parents at daycare after becoming the very best like no one ever was") {
            retrieveCurrentStoryPart();
            retrieveCurrentStoryChoices();
            for (let parts in currentStory) {
                text += currentStory.shift;
            }
        }
    }
 
    function retrieveCurrentStoryPart () {
        let currentStoryPart = "";
        let storyPartsArray = Object.keys(storyObject.storyParts);
        let lastStoryPart = currentStory.pop();
        currentStory.push(lastStoryPart);
        for (let parts in currentStory) {
            if (currentStory[parts] === lastStoryPart) {
                currentStoryPart = storyObject.storyParts[storyPartsArray[Number(parts)]];
                currentStory.push(currentStoryPart);
                return currentStoryPart;
            }
        }
    }
 
    function retrieveCurrentStoryChoices () {
        let currentStoryChoices = [];
        if (Object.keys(currentStory[0]).length === 0) {
            Object.assign(currentStory[0], storyObject.choices.goToForest);
            currentStoryChoices.push(storyObject.choices.goToForest);
            Object.assign(currentStory[0], storyObject.choices.goToRuins);
            currentStoryChoices.push(storyObject.choices.goToRuins);
            Object.assign(currentStory[0], storyObject.choices.goToCave);
            currentStoryChoices.push(storyObject.choices.goToCave);
        } else {
            let storyChoices = Object.keys(storyObject.choices);
            let lastStoryChoices = Object.keys(currentStory[0]).pop();
            let currentChoice = null;
            for (let choice in storyObject.choices) {
                currentChoice = storyObject.choices[choice];
                if (currentChoice[1] === Number(lastStoryChoices) + 1) {
                    currentStoryChoices.push(storyObject.choices[choice]);
                }
            }
        }
        return currentStoryChoices;
    }
 


    </script>
</body>
</html>